{
  "_args": [
    [
      {
        "raw": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
        "scope": null,
        "escapedName": null,
        "name": null,
        "rawSpec": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
        "spec": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
        "type": "remote"
      },
      "/Users/alexandermurphy/Documents/galvanize/classwork/e2e-1"
    ]
  ],
  "_from": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
  "_id": "bookshelf-modelbase@2.10.1",
  "_inCache": true,
  "_installable": true,
  "_location": "/bookshelf-modelbase",
  "_phantomChildren": {},
  "_requested": {
    "raw": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
    "scope": null,
    "escapedName": null,
    "name": null,
    "rawSpec": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
    "spec": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
    "type": "remote"
  },
  "_requiredBy": [
    "#USER",
    "/"
  ],
  "_resolved": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
  "_shasum": "0f6c7a907b891ffe374245e1da3bdce9d2560a9c",
  "_shrinkwrap": null,
  "_spec": "https://github.com/thexande/bookshelf-modelbase/tarball/master",
  "_where": "/Users/alexandermurphy/Documents/galvanize/classwork/e2e-1",
  "author": {
    "name": "Basil Siddiqui",
    "email": "basil.siddiqui@gmail.com"
  },
  "bugs": {
    "url": "https://github.com/bsiddiqui/bookshelf-modelbase/issues"
  },
  "dependencies": {
    "joi": "^5.0.2",
    "lodash.difference": "^3.2.2",
    "xtend": "^4.0.0"
  },
  "description": "Extensible ModelBase for bookshelf-based model layers",
  "devDependencies": {
    "bluebird": "^2.10.0",
    "bookshelf": "^0.9.1",
    "chai": "^1.10.0",
    "istanbul": "^0.3.5",
    "knex": "^0.7.3",
    "mocha": "^2.0.1",
    "sinon": "^1.12.1",
    "sqlite3": "^3.0.4",
    "standard": "5.0.2"
  },
  "homepage": "https://github.com/bsiddiqui/bookshelf-modelbase",
  "license": "MIT",
  "main": "./lib",
  "name": "bookshelf-modelbase",
  "optionalDependencies": {},
  "readme": "# bookshelf-modelbase\n[![Build Status](https://travis-ci.org/bsiddiqui/bookshelf-modelbase.svg?branch=master)](https://travis-ci.org/bsiddiqui/bookshelf-modelbase) [![Code Climate](https://codeclimate.com/github/bsiddiqui/bookshelf-modelbase/badges/gpa.svg)](https://codeclimate.com/github/bsiddiqui/bookshelf-modelbase) [![Test Coverage](https://codeclimate.com/github/bsiddiqui/bookshelf-modelbase/badges/coverage.svg)](https://codeclimate.com/github/bsiddiqui/bookshelf-modelbase) [![Version](https://badge.fury.io/js/bookshelf-modelbase.svg)](http://badge.fury.io/js/bookshelf-modelbase) [![Downloads](http://img.shields.io/npm/dm/bookshelf-modelbase.svg)](https://www.npmjs.com/package/bookshelf-modelbase)\n\n## Why\n[Bookshelf.js](https://github.com/tgriesser/bookshelf) is awesome. However,\nwe found ourselves extending `bookshelf.Model` for the same reasons over and\nover - parsing and formatting (to and from DB) niceties, adding timestamps, and\nvalidating data on save, for example. Since these are problems you'll likely\nhave to solve for most use cases of Bookshelf, it made sense to provide a\nconvenient set of core model features.\n\n### Please note\n* `bookshelf-modelbase` will not force you to use it for all your models.\nIf you want to use it for some and not others, nothing bad will happen.\n\n* `bookshelf-modelbase` requires you to pass in an initialized instance\nof bookshelf, meaning that you can configure bookshelf however you please.\nOutside of overriding `bookshelf.Model`, there is nothing you can do to\nyour bookshelf instance that will break `bookshelf-modelbase`.\n\n### Features\n* Adds timestamps (`created_at` and `updated_at`)\n\n* Validate own attributes on save using [Joi](https://github.com/hapijs/joi).\nYou can pass in a validation object as a class attribute when you extend\n`bookshelf-modelbase` - see below for usage.\n\n* Naive CRUD methods - `findAll`, `findOne`, `findOrCreate`, `create`, `update`, and `destroy`\n\n## Usage\n```javascript\nvar db        = require(knex)(require('./knexfile'));\nvar bookshelf = require('bookshelf')(db);\n// Pass an initialized bookshelf instance\nvar ModelBase = require('bookshelf-modelbase')(bookshelf);\n// Or initialize as a bookshelf plugin\nbookshelf.plugin(require('bookshelf-modelbase').pluggable);\n\nvar User = ModelBase.extend({\n  tableName: 'users'\n\n  // validation is passed to Joi.object(), so use a raw object\n  validate: {\n    firstName: Joi.string()\n  }\n});\n\nUser.create({ firstName: 'Grayson' })\n.then(function () {\n  return User.findOne({ firstName: 'Grayson' }, { require: true });\n})\n.then(function (grayson) {\n  // passes patch: true to .save() by default\n  return User.update({ firstName: 'Basil' }, { id: grayson.id });\n})\n.then(function (basil) {\n  return User.destroy({ id: basil.id });\n})\n.then(function () {\n  return User.findAll();\n})\n.then(function (collection) {\n  console.log(collection.models.length); // => 0\n})\n\n```\n\n### API\n\n#### model.create\n\n```js\n/**\n  * Naive add - create and save a model based on data\n  * @param {Object} data\n  * @param {Object} options (optional)\n  * @return {Promise(bookshelf.Model)} single Model\n  */\ncreate: function (data, options) {\n  return this.forge(data)\n  .save(null, options);\n}\n```\n\n#### model.destroy\n\n```js\n/**\n  * Naive destroy\n  * @param {Object} options\n  * @return {Promise(bookshelf.Model)} empty Model\n  */\ndestroy: function (options) {\n  return this.forge({ [this.prototype.idAttribute]: options.id })\n  .destroy(options);\n}\n```\n\n#### model.findAll\n\n```javascript\n/**\n  * Naive findAll - fetches all data for `this`\n  * @param {Object} options (optional)\n  * @return {Promise(bookshelf.Collection)} Bookshelf Collection of all Models\n  */\nfindAll: function (options) {\n  return bookshelf.Collection.forge([], { model: this }).fetch(options);\n}\n```\n\n#### model.findById\n\n```javascript\n/**\n * Find a model based on it's ID\n * @param {String} id The model's ID\n * @param {Object} [options] Options used of model.fetch\n * @return {Promise(bookshelf.Model)}\n */\nfindById: function (id, options) {\n  return this.findOne({ [this.prototype.idAttribute]: id }, options)\n}\n```\n\n#### model.findOne\n\n```js\n/**\n  * Naive findOne - fetch data for `this` matching data\n  * @param {Object} data\n  * @param {Object} options (optional)\n  * @return {Promise(bookshelf.Model)} single Model\n  */\nfindOne: function (data, options) {\n  return this.forge(data).fetch(options);\n}\n```\n\n#### model.findOrCreate\n```js\n/**\n  * Find or create - try and find the model, create one if not found\n  * @param {Object} data\n  * @param {Object} options\n  * @return {Promise(bookshelf.Model)} single Model\n  */\nfindOrCreate: function (data, options) {\n  var self = this;\n\n  return self.findOne(data, options)\n  .then(function (model) {\n    return model ? model : self.create(data, options);\n  })\n}\n```\n#### model.findOrCreateById\n```js\nfindOrCreateById: function (data, options, id) {\n  return this.findOne({ [this.prototype.idAttribute]: id }, extend(options, { require: false }))\n  .bind(this)\n  .then(function (model) {\n    var defaults = options && options.defaults\n    return model ?\n      model :\n      this.create(extend(defaults, data), options)\n  })\n}\n```\n#### model.findOrCreateByProperty\n```js\n\n/**\n  * Select a model based on data with contents of query and insert if not found\n  * @param {Object} data\n  * @param {Object} [options] Options for model.fetch and model.save\n  * @param {Object} [options.defaults] Defaults to apply to a create\n  * @param {Object} [query]\n  * @return {Promise(bookshelf.Model)} single Model\n  */\nfindOrCreateByProperty: function (data, options, query) {\n  return this.findOne(query, extend(options, { require: false }))\n  .bind(this)\n  .then(function (model) {\n    var defaults = options && options.defaults\n    return model ?\n      model :\n      this.create(extend(defaults, data), options)\n  })\n}\n```\n#### model.update\n\n```js\n/**\n  * Naive update - update a model based on data\n  * @param {Object} data\n  * @param {Object} options\n  * @return {Promise(bookshelf.Model)} edited Model\n  */\nupdate: function (data, options) {\n  _.defaults(options, {\n    patch: true\n  });\n  return this.forge({ [this.prototype.idAttribute]: options.id }).fetch(options)\n  .then(function (model) {\n    if (model) {\n      return model.save(data, options);\n    }\n  })\n}\n```\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git://github.com/bsiddiqui/bookshelf-modelbase.git"
  },
  "scripts": {
    "test": "standard && istanbul cover _mocha"
  },
  "version": "2.10.1"
}
